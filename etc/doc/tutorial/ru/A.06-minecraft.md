A.6 Musical Minecraft 

# Музыкальный Minecraft

Привет, и с возвращением! В предыдущих упражнениях мы сосредотачивались
исключительно на музыкальных возможностях Sonic Pi - (превращая ваш Raspberry
Pi в готовый к выступлению музыкальный инструмент). К этому моменту мы 
научились:

- Кодировать в реальном времени, 
- Создавать различные ритмы, 
- Генерировать мощные солирующие синты,
- Воссоздавать знаменитые кислотные басы TB-303.

Однако, есть ещё множество аспектов создания музыки, которые нужно показать вам
(что я и сделаю в будущем). Но в этом месяце мы рассмотрим особенность Sonic
Pi, о наличии которой вы, наверное, даже и не подозревали: управлять Minecraft.

# Привет, Мир Minecraft

ОК, давайте начнём. Подключите ваш Raspberry Pi, запустите Minecraft Pi и
создайте новый мир. Теперь запустите Sonic Pi, измените размеры окон и 
разместите их так, чтобы вы могли видеть одновременно и Minecraft Pi,
и Sonic Pi.

В пустом буфере наберите следующее:


    mc_message "Hello Minecraft from Sonic Pi!"

    
Теперь, нажмите "Выполнить". Бум! Ваше сообщение появилось в Minecraft! Ну как,
это было легко? Теперь, прекратите на мгновение чтение этой статьи и поиграйте
с вашими собственными сообщениями. Веселитесь!

![Screen 0](../images/tutorial/articles/A.06-minecraft/Musical-Minecraft-0-small.png)

# Sonic Телепортатор

Теперь давайте исследовать мир Minecraft. Стандартный вариант - дотянуться до
мыши и клавиатуры и начать перемещаться в мире Minecraft. Это работает, но это
довольно медленно и скучно. Было бы гораздо интереснее, если бы у нас было
что-то вроде телепортатора. Благодаря Sonic Pi, мы имеем один. Попробуйте это:


    mc_teleport 80, 40, 100

    
Боже мой! Это был долгий путь вверх. Если вы не находились в режиме полёта, то
должны были упасть обратно на землю. Если вы дважды нажмёте пробел для входа в
режим полёта и телепортируетесь снова, вы останетесь висеть на том месте, куда
вы в телепортировались.

Итак, что же означают эти цифры? У нас есть три числа, которые описывают 
координаты места, куда мы хотим переместиться. Мы даём каждой цифре имя -
х, y и z:

- x - как далеко от левого края (в нашем примере - 80) 
- y - как высоко (в нашем примере - 40) 
- z - как далеко вглубь мира (в нашем примере - 100)

Выбирая различные значения для x, y и z, мы можем телепортироваться *куда
угодно*. Попробуйте! Выбирайте различные цифры и смотрите, где вы окажетесь.
Если экран стал чёрным, это произошло потому, что вы телепортировали себя под
землю или внутрь скалы. Просто выбирите значение `y` выше, чтобы оказаться
снова над землёй. Продолжайте исследования, пока не найдёте место, которое вам
понравится...

Используя эти идеи, построим телепортатор, который издаёт весёлый звук
телепортации, пока переносит нас сквозь мир Minecraft:


    mc_message "Preparing to teleport...."
    sample :ambi_lunar_land, rate: -1
    sleep 1
    mc_message "3"
    sleep 1
    mc_message "2"
    sleep 1
    mc_message "1"
    sleep 1
    mc_teleport 90, 20, 10
    mc_message "Whoooosh!"

    
![Screen 1](../images/tutorial/articles/A.06-minecraft/Musical-Minecraft-1-small.png)

# Магические Блоки

Сейчас, когда вы нашли хорошее место, начнём строительство. Вы могли бы делать
то, к чему привыкли, и начать яростно кликать мышкой, распологая блоки под
курсором. Или вы могли бы использовать магию Sonic Pi. Попробуйте это:


    x, y, z = mc_location
    mc_set_block :melon, x, y + 5, z


Теперь посмотри вверх! В небе дынный блок! Найдите минутку, чтобы посмотреть на
код. Что он делает? На первой строке мы определили текущее местоположение как
переменные x, y и z. Они соответствуют нашим координатам, описанным выше. Мы
использовали эти координаты в функции `mc_set_block`, которая поместила блок,
который мы выбрали, по указанным координатам. Чтобы указать сделать что-то выше
в небе, нам просто нужно увеличить значение `y`, вот почему мы добавляем 5 к
нему. Сделаем длинный след из этих блоков:


    live_loop :melon_trail do
      x, y, z = mc_location
      mc_set_block :melon, x, y-1, z
      sleep 0.125
    end


Теперь переключитесь на Minecraft, убедитесь что вы находитесь в режиме полёта
(двойное нажатие на пробел, если нет) и летайте по всему миру. Обернитесь,
чтобы увидеть длинный след дынных блоков! Посмотрите, какие извилистые
структуры вы можете сделать в небе.

# Лайвкодинг Minecraft

Тем из вас, кто следит за этими статьями в течение последних нескольких
месяцев, наверное снесёт крышу к этому моменту. След дынных блоков это очень
здорово, но самая захватывающая часть предыдущего пример заключается в том, что
вы можете использовать `live_loop` с Minecraft! Для тех, кто не знает, цикл
`live_loop` в Sonic Pi - особая магическая способность, которой нет других
языках программирования. Он позволяет запускать несколько циклов в одно и то
же время и изменять их, пока они выполняются. Они невероятно мощные и
удивительно весёлые. Я использую `live_loop`, чтобы исполнять музыку в ночных
клубах с Sonic Pi - диджеи используют диски, а я циклы `live_loop` :-) Тем не
менее, сегодня мы собираемся кодировать в реальном времени и музыку, 
и Minecraft.

Давайте начнём. Запустите приведенный выше код и начните делать свой дынный
след снова. Теперь, не останавливая код, просто измените `:melon` на `:brick`
и нажмите "Выполнить". Вуаля, вы теперь делаете кирпичную дорогу. Это было
просто! Добавим немного музыки в это? Легко. Попробуйте это:


    live_loop :bass_trail
      tick
      x, y, z = mc_location
      b = (ring :melon, :brick, :glass).look
      mc_set_block b, x, y -1, z
      note = (ring :e1, :e2, :e3).look
      use_synth :tb303
      play note, release: 0.1, cutoff: 70
      sleep 0.125
    end


Теперь, пока это играет, начнём вносить изменения в наш код. Измените тип
блока. Попробуйте `:water`, `:grass` или другой ваш любимый тип блока. Также,
попробуйте изменть значение отсечки фильтра с `70` до `80` и затем до `100`.
Разве это не весело?

# Соберём Всё Вместе

![Screen 2](../images/tutorial/articles/A.06-minecraft/Musical-Minecraft-2-small.png)

Давайте объединим всё, что мы видели до сих пор, с небольшой дополнительной 
магией. Совместим наши способности к телепортации с размещением блоков и
музыкой, сделав музыкальное видео Minecraft. Не волнуйтесь, если вы не всё
здесь понимаете, просто введите код в буфер и играйте, изменяя значения, пока
код выполняется. Повеселитесь и увидимся в следующий раз...
    

    live_loop :note_blocks do
      mc_message "This is Sonic Minecraft"
      with_fx :reverb do
        with_fx :echo, phase: 0.125, reps: 32 do
          tick
          x = (range 30, 90, step: 0.1).look
          y = 20
          z = -10
          mc_teleport x, y, z
          ns = (scale :e3, :minor_pentatonic)
          n = ns.shuffle.choose
          bs = (knit :glass, 3, :sand, 1)
          b = bs.look
          synth :beep, note: n, release: 0.1
          mc_set_block b, x+20, n-60+y, z+10
          mc_set_block b, x+20, n-60+y, z-10
          sleep 0.25
        end
      end
    end
    
    live_loop :beats do
      sample :bd_haus, cutoff: 100
      sleep 0.5
    end
